<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Areal Interpolation in `R` • areal</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Areal Interpolation in `R`">
<meta property="og:description" content="areal">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">areal</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.8.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/areal.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/slu-openGIS/areal/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Areal Interpolation in <code>R</code>
</h1>
                        <h4 data-toc-skip class="author">Christopher Prener, Ph.D.</h4>
            
            <h4 data-toc-skip class="date">2022-05-29</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/slu-openGIS/areal/blob/HEAD/vignettes/areal.Rmd" class="external-link"><code>vignettes/areal.Rmd</code></a></small>
      <div class="hidden name"><code>areal.Rmd</code></div>

    </div>

    
    
<p>Areal interpolation is the process making estimates from a source set of polygons to an overlapping but incongruent set of target polygons. This is required if, for example, a researcher wants to derive population estimates for neighborhoods in a U.S. city from the Census Bureau’s census tracts. Neighborhoods do not typically align with census tract boundaries, and areal interpolation can be used to produce estimates in this situation.</p>
<div class="section level2">
<h2 id="motivation">Motivation<a class="anchor" aria-label="anchor" href="#motivation"></a>
</h2>
<p>As helpful as this may be, areal interpolation is not widely used. Many neighborhood researchers use census tracts, census block groups, or even zip codes as proxies for neighborhoods instead of interpolating values from these underlying sources into the actual neighborhoods. A key reason many researchers do not take this second step is that desktop GIS applications have not historically offered built-in tools for completing these calculations. Thus researchers wishing to use areal interpolation must “reinvent the wheel” (Qiu et al. 2012) when it comes to developing processes for carrying out areal interpolation.</p>
<p>In <code>R</code>, the <code>sf</code> package does offer a basic interface for areal weighted interpolation (<code>st_interpolate_aw</code>). While this functionality is welcome and useful, its implementation requires extensive data cleaning to carry out multiple interpolations (or the use of a tool like <code>purrr</code>). The process is also a “black box” - the interpolations are produced without a means to dis-aggregate the process into its constituent elements.</p>
<p><code>areal</code> is designed as an alternative to this approach. For its initial release, the package offers a specific approach to interpolation known as areal weighted interpolation with several distinct features. Iteration is built-in and does not require using the apply family of functions from <code>base</code> or tools from <code>purrr</code>. Users have multiple choices available both in terms of how interpolations are calculated and how output is structured. The key function, <code><a href="../reference/aw_interpolate.html">aw_interpolate()</a></code> is pipe-able, meaning it fits into existing <code>tidyverse</code> workflows. Helper functions are provided to validate data and make decisions about which areal weight to implement. And finally, the areal weighted interpolation process can be dis-aggregated by applying the necessary functions in sequence.</p>
<p>What results from areal interpolation is mapped below. We begin with a common unit of spatial data aggregation - the census tract. Total population per tract is mapped on the left in panel A. Using the <code>areal</code> package, we estimate population counts for wards in St. Louis from those census tract values. These estimated values are mapped on the right in panel B.</p>
<p><img src="../reference/figures/exampleMap.png" width="100%"></p>
</div>
<div class="section level2">
<h2 id="getting-started">Getting Started<a class="anchor" aria-label="anchor" href="#getting-started"></a>
</h2>
<div class="section level3">
<h3 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h3>
<p>We recommend that users install <code>sf</code> before proceeding with the installation of <code>areal</code>. Windows users should be able to install <code>sf</code> without significant issues, but macOS and Linux users will need to install several open source spatial libraries to get <code>sf</code> itself up and running. The easiest approach for macOS users is to install the GDAL 2.0 Complete framework from <a href="https://www.kyngchaos.com/software/frameworks/" class="external-link">Kyng Chaos</a>.</p>
<p>For Linux users, steps will vary based on the flavor being used. Our <a href="https://github.com/slu-openGIS/areal/blob/master/.travis.yml" class="external-link">configuration file</a> for Travis CI and its associated <a href="https://github.com/slu-openGIS/areal/blob/master/.travis/install.sh" class="external-link">bash script</a> should be useful in determining the necessary components to install. Linux users will need to make sure the dependency <a href="https://github.com/r-spatial/lwgeom" class="external-link"><code>lwgeom</code></a> is also installed correctly.</p>
<p>Once <code>sf</code> is installed, the easiest way to get <code>areal</code> is to install it from CRAN:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"areal"</span><span class="op">)</span></code></pre></div>
<p>Alternatively, the development version of <code>areal</code> can be accessed from GitHub with <code>remotes</code>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># install.packages("remotes")</span>
<span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"slu-openGIS/areal"</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="functions">Functions<a class="anchor" aria-label="anchor" href="#functions"></a>
</h3>
<p>Two function prefixes are used in <code>areal</code> to allow users to take advantage of RStudio’s auto complete functionality:</p>
<ul>
<li>
<code>ar_</code> - data and functions that are used for multiple interpolation methods</li>
<li>
<code>aw_</code> - functions that are used specifically for areal weighted interpolation</li>
</ul>
</div>
<div class="section level3">
<h3 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h3>
<p>The package contains four overlapping data sets that can be used for practice:</p>
<ul>
<li>
<code>ar_stl_race</code> (2017 ACS demographic counts at the census tract level; <em>n</em> = 106)</li>
<li>
<code>ar_stl_asthma</code> (2017 asthma rates at the census tract level; <em>n</em> = 106)</li>
<li>
<code>ar_stl_wards</code> (the 2010 political subdivisions in St. Louis; <em>n</em> = 28).</li>
<li>
<code>ar_stl_wardsClipped</code> (the 2010 political subdivisions in St. Louis clipped to the Mississippi River shoreline; <em>n</em> = 28).</li>
</ul>
</div>
<div class="section level3">
<h3 id="preparing-data">Preparing Data<a class="anchor" aria-label="anchor" href="#preparing-data"></a>
</h3>
<p><code>areal</code> assumes that all data are available as <code>sf</code> objects. The <code>st_read()</code> function is useful for importing data stored in a variety of formats into <code>sf</code> objects. Creating these objects is a pre-requisite to passing the validation steps before interpolations are completed.</p>
<p>It is also recommended that all data are stored using a projected coordinate system as opposed to a geographic coordinate system like NAD 1983 or WGS 1984. There are many projected coordinate systems to choose from, but the key is that all of your data is projected using the same system. Here too the <code>sf</code> package has built-in functionality - the <code>st_transform()</code> function can be used for data re-projection.</p>
<p>Finally, we strongly suggest that you clean out unnecessary columns from your data prior to projection. <code>sf</code> objects can be cleaned using <code>tidyverse</code> tools from <code>dplyr</code>, which makes it easy to <code><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select()</a></code> the columns and <code><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter()</a></code> the observations you want to focus on for interpolation. Columns can also be easily renamed using <code><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename()</a></code>.</p>
<p>Once data have been converted to <code>sf</code> objects, re-projected into the same planar coordinate systems, and cleaned, they are ready for interpolation!</p>
<p>The data preparation process is described in greater detail in a <a href="https://slu-opengis.github.io/areal/articles/data-preparation.html" class="external-link">dedicated vignette</a>.</p>
</div>
<div class="section level3">
<h3 id="areal-weighted-interpolation">Areal Weighted Interpolation<a class="anchor" aria-label="anchor" href="#areal-weighted-interpolation"></a>
</h3>
<p>Areal weighted interpolation makes a single, albeit significant, assumption about your data - that populations are evenly distributed within the source data. Imagine you have a census tract with 3,000 residents. Areal weighted interpolation will assume that these 3,000 residents are evenly spread out within that tract. This may not matter in some tracts, but in tracts with large parks or dense housing developments alongside commercial buildings, this assumption is not likely to hold.</p>
<p>The primary means for conducting interpolations, and possibly the only function you may need from <code>areal</code>, is the <code><a href="../reference/aw_interpolate.html">aw_interpolate()</a></code> function:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## load dependencies</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/slu-openGIS/areal" class="external-link">areal</a></span><span class="op">)</span>

<span class="co">## interpolate values</span>
<span class="fu"><a href="../reference/aw_interpolate.html">aw_interpolate</a></span><span class="op">(</span><span class="va">ar_stl_wards</span>, tid <span class="op">=</span> <span class="va">WARD</span>, source <span class="op">=</span> <span class="va">ar_stl_race</span>, sid <span class="op">=</span> <span class="st">"GEOID"</span>, 
               weight <span class="op">=</span> <span class="st">"sum"</span>, output <span class="op">=</span> <span class="st">"sf"</span>, extensive <span class="op">=</span> <span class="st">"TOTAL_E"</span><span class="op">)</span></code></pre></div>
<p>The function is capable of both spatially extensive and intensive interpolations, and can use two different strategies for calculating areal weights for extensive interpolations. It can also produce output as either <code>tibble</code> or <code>sf</code> objects. These options are all documented in both the function documentation (use <code><a href="../reference/aw_interpolate.html">?aw_interpolate</a></code>) as well as in a <a href="https://slu-opengis.github.io/areal/articles/areal-weighted-interpolation.html" class="external-link">dedicated vignette</a>.</p>
</div>
</div>
<div class="section level2">
<h2 id="getting-help">Getting Help<a class="anchor" aria-label="anchor" href="#getting-help"></a>
</h2>
<ul>
<li>If you are new to <code>R</code> itself, welcome! Hadley Wickham’s <a href="https://r4ds.had.co.nz" class="external-link"><em>R for Data Science</em></a> is an excellent way to get started with data manipulation in the tidyverse, which <code>areal</code> is designed to integrate seamlessly with.</li>
<li>If you are new to spatial analysis in <code>R</code>, we strongly encourage you check out the excellent new <a href="https://geocompr.robinlovelace.net" class="external-link"><em>Geocomputation in R</em></a> by Robin Lovelace, Jakub Nowosad, and Jannes Muenchow.</li>
<li>If you have questions about using <code>areal</code>, you are encouraged to use the <a href="https://community.rstudio.com" class="external-link">RStudio Community forums</a>. Please create a <a href="https://reprex.tidyverse.org/" class="external-link"><code>reprex</code></a> before posting. Feel free to tag Chris (<code>@chris.prener</code>) in any posts about <code>areal</code>.</li>
<li>If you think you’ve found a bug, please create a <a href="https://reprex.tidyverse.org/" class="external-link"><code>reprex</code></a> and then open an issue on <a href="https://github.com/slu-openGIS/areal/issues/new/choose" class="external-link">GitHub</a>.</li>
</ul>
</div>
<div class="section level2">
<h2 id="suggesting-features-or-changes">Suggesting Features or Changes<a class="anchor" aria-label="anchor" href="#suggesting-features-or-changes"></a>
</h2>
<p>We are planning to experiment with at least three additional techniques for areal interpolation for possible inclusion into the package. These include:</p>
<ul>
<li>
<a href="https://github.com/slu-openGIS/areal/issues/1" class="external-link">Pycnophylactic method</a> (raster based, eliminates the sharp transitions in value between target features)</li>
<li>
<a href="https://github.com/slu-openGIS/areal/issues/2" class="external-link">Binary dasymetric method</a> (incorporates ancillary data so that population is not assumed to be evenly distributed within units)</li>
<li>
<a href="https://github.com/slu-openGIS/areal/issues/3" class="external-link">3-class regression dasymetric method</a> (allows for a more complex estimation based on multiple forms of ancillary data)</li>
</ul>
<p>We do not have a timeline for these experiments, though we are planning to begin experimenting with the pycnophylactic method in the coming months. We will be keeping the issues (linked to above) updated with progress. If you are interested in bringing these techniques to <code>R</code>, please feel free to contribute to the development of <code>areal</code>. The best place to start is bt checking in on our GitHub issues for each technique to see what help is needed!</p>
<p>If you have other features or suggestions you want to see, please open an issue on <a href="https://github.com/slu-openGIS/areal/issues/new/choose" class="external-link">GitHub</a> (and ideally created a <a href="https://reprex.tidyverse.org/" class="external-link"><code>reprex</code></a> to go with it!). Please note that this project is released with a <a href="https://slu-opengis.github.io/areal/CODE_OF_CONDUCT.html" class="external-link">Contributor Code of Conduct</a>. By participating in this project you agree to abide by its terms.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://chris-prener.github.io" class="external-link">Christopher Prener</a>, Charlie Revord, Branson Fox.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
